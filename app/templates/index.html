<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Video URL Scanner</title>
  <style>
    :root {
      --bg-desktop: url('/static/rain-bar.gif');
      --bg-mobile: url('/static/cozy-aesthetic.gif');
    }
    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: #fff;
    }
    body {
      background: var(--bg-desktop) no-repeat center center fixed;
      background-size: cover;
      display: grid;
      place-items: center;
      padding: 16px;
    }
    @media (max-width: 768px) {
      body {
        background: var(--bg-mobile) no-repeat center center fixed;
        background-size: cover;
      }
    }
    .card {
      width: 100%;
      max-width: 720px;
      background: rgba(0, 0, 0, 0.55);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      backdrop-filter: blur(4px);
    }
    h1 { margin: 0 0 12px; font-weight: 700; }
    p.helper { margin-top: 0; opacity: 0.9; }
    .row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 16px;
    }
    input[type="text"] {
      flex: 1 1 420px;
      min-width: 220px;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.25);
      background: rgba(255,255,255,0.12);
      color: #fff;
      outline: none;
    }
    button {
      padding: 12px 16px;
      border-radius: 12px;
      border: none;
      background: #ffffff;
      color: #000;
      cursor: pointer;
      font-weight: 600;
    }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    #results { margin-top: 16px; text-align: left; max-height: 45vh; overflow: auto; }
    .link-item {
      background: rgba(255,255,255,0.08);
      padding: 10px 12px;
      border-radius: 8px;
      margin-bottom: 8px;
      word-break: break-all;
    }
    .success { color: #7CFFB2; }
    .error { color: #FFD6D6; }
    .muted { opacity: 0.8; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Video URL Scanner</h1>
    <p class="helper">Paste a Pinterest/TikTok/etc. URL and we'll extract the direct stream links. The video downloads temporarily and is deleted immediately after links are found.</p>

    <div class="row">
      <input type="text" id="urlBox" placeholder="Paste video URL here" />
      <button id="scanBtn" onclick="scan()">Scan</button>
    </div>

    <div id="results" class="muted">Results will appear hereâ€¦</div>
  </div>

  <script>
    async function scan() {
      const input = document.getElementById("urlBox");
      const btn = document.getElementById("scanBtn");
      const resultsDiv = document.getElementById("results");
      const val = (input.value || "").trim();
      resultsDiv.innerHTML = "";

      // Easter egg ðŸ’™
      if (val.toLowerCase() === "azhar") {
        resultsDiv.innerHTML = "<h2>Azhar will always love you forever ðŸ’•</h2>";
        return;
      }

      if (!val) {
        resultsDiv.innerHTML = "<p class='error'>Please paste a URL first.</p>";
        return;
      }

      btn.disabled = true;
      resultsDiv.innerHTML = "<p>Scanningâ€¦</p>";
      try {
        const res = await fetch(`/scan?url=${encodeURIComponent(val)}`);
        const data = await res.json();
        if (data.error) {
          resultsDiv.innerHTML = `<p class='error'>Error: ${data.error}</p>`;
          return;
        }
        if (data.links && data.links.length) {
          resultsDiv.innerHTML = "<h3 class='success'>Found Links:</h3>";
          data.links.forEach(link => {
            const div = document.createElement("div");
            div.className = "link-item";
            const a = document.createElement("a");
            a.href = link;
            a.textContent = link;
            a.target = "_blank";
            div.appendChild(a);
            resultsDiv.appendChild(div);
          });
        } else {
          resultsDiv.innerHTML = "<p>No links found.</p>";
        }
      } catch (e) {
        resultsDiv.innerHTML = `<p class='error'>Unexpected error: ${e}</p>`;
      } finally {
        btn.disabled = false;
      }
    }
  </script>
</body>
</html>
